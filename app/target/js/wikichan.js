!function(t){var e={};function i(n){if(e[n])return e[n].exports;var s=e[n]={i:n,l:!1,exports:{}};return t[n].call(s.exports,s,s.exports,i),s.l=!0,s.exports}i.m=t,i.c=e,i.d=function(t,e,n){i.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},i.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},i.t=function(t,e){if(1&e&&(t=i(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(i.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var s in t)i.d(n,s,function(e){return t[e]}.bind(null,s));return n},i.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return i.d(e,"a",e),e},i.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},i.p="",i(i.s=1)}([function(t,e,i){var n;(function(){function i(t,e,i,n){return new s(t,e,i,n)}function s(t,e,i,n){this.options=n||{},this.options.adapters=this.options.adapters||{},this.obj=t,this.keypath=e,this.callback=i,this.objectPath=[],this.update=this.update.bind(this),this.parse(),r(this.target=this.realize())&&this.set(!0,this.key,this.target,this.callback)}function r(t){return"object"==typeof t&&null!==t}function o(t){throw new Error("[sightglass] "+t)}i.adapters={},s.tokenize=function(t,e,i){var n,s,r=[],o={i:i,path:""};for(n=0;n<t.length;n++)s=t.charAt(n),~e.indexOf(s)?(r.push(o),o={i:s,path:""}):o.path+=s;return r.push(o),r},s.prototype.parse=function(){var t,e,n=this.interfaces();n.length||o("Must define at least one adapter interface."),~n.indexOf(this.keypath[0])?(t=this.keypath[0],e=this.keypath.substr(1)):(void 0===(t=this.options.root||i.root)&&o("Must define a default root adapter."),e=this.keypath),this.tokens=s.tokenize(e,n,t),this.key=this.tokens.pop()},s.prototype.realize=function(){var t,e=this.obj,i=!1;return this.tokens.forEach(function(n,s){r(e)?(void 0!==this.objectPath[s]?e!==(t=this.objectPath[s])&&(this.set(!1,n,t,this.update),this.set(!0,n,e,this.update),this.objectPath[s]=e):(this.set(!0,n,e,this.update),this.objectPath[s]=e),e=this.get(n,e)):(!1===i&&(i=s),(t=this.objectPath[s])&&this.set(!1,n,t,this.update))},this),!1!==i&&this.objectPath.splice(i),e},s.prototype.update=function(){var t,e;(t=this.realize())!==this.target&&(r(this.target)&&this.set(!1,this.key,this.target,this.callback),r(t)&&this.set(!0,this.key,t,this.callback),e=this.value(),this.target=t,(this.value()instanceof Function||this.value()!==e)&&this.callback())},s.prototype.value=function(){if(r(this.target))return this.get(this.key,this.target)},s.prototype.setValue=function(t){r(this.target)&&this.adapter(this.key).set(this.target,this.key.path,t)},s.prototype.get=function(t,e){return this.adapter(t).get(e,t.path)},s.prototype.set=function(t,e,i,n){var s=t?"observe":"unobserve";this.adapter(e)[s](i,e.path,n)},s.prototype.interfaces=function(){var t=Object.keys(this.options.adapters);return Object.keys(i.adapters).forEach(function(e){~t.indexOf(e)||t.push(e)}),t},s.prototype.adapter=function(t){return this.options.adapters[t.i]||i.adapters[t.i]},s.prototype.unobserve=function(){var t;this.tokens.forEach(function(e,i){(t=this.objectPath[i])&&this.set(!1,e,t,this.update)},this),r(this.target)&&this.set(!1,this.key,this.target,this.callback)},t.exports?t.exports=i:void 0===(n=function(){return this.sightglass=i}.apply(e,[]))||(t.exports=n)}).call(this)},function(t,e,i){i(7),t.exports=i(4)},function(t,e,i){(function(t){var n,s;(function(){var r,o,h,a,l,u=function(t,e){return function(){return t.apply(e,arguments)}},c=[].slice,p={}.hasOwnProperty,d=function(t,e){for(var i in e)p.call(e,i)&&(t[i]=e[i]);function n(){this.constructor=t}return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},f=[].indexOf||function(t){for(var e=0,i=this.length;e<i;e++)if(e in this&&this[e]===t)return e;return-1};r={options:["prefix","templateDelimiters","rootInterface","preloadData","handler","executeFunctions"],extensions:["binders","formatters","components","adapters"],public:{binders:{},components:{},formatters:{},adapters:{},prefix:"rv",templateDelimiters:["{","}"],rootInterface:".",preloadData:!0,executeFunctions:!1,iterationAlias:function(t){return"%"+t+"%"},handler:function(t,e,i){return this.call(t,e,i.view.models)},configure:function(t){var e,i,n,s;for(n in null==t&&(t={}),t)if(s=t[n],"binders"===n||"components"===n||"formatters"===n||"adapters"===n)for(i in s)e=s[i],r[n][i]=e;else r.public[n]=s},bind:function(t,e,i){var n;return null==e&&(e={}),null==i&&(i={}),(n=new r.View(t,e,i)).bind(),n},init:function(t,e,i){var n,s,o;if(null==i&&(i={}),null==e&&(e=document.createElement("div")),(s=(t=r.public.components[t]).template.call(this,e))instanceof HTMLElement){for(;e.firstChild;)e.removeChild(e.firstChild);e.appendChild(s)}else e.innerHTML=s;return n=t.initialize.call(this,e,i),(o=new r.View(e,n)).bind(),o}}},window.jQuery||window.$?(l="on"in(h=window.jQuery||window.$).prototype?["on","off"]:["bind","unbind"],o=l[0],a=l[1],r.Util={bindEvent:function(t,e,i){return h(t)[o](e,i)},unbindEvent:function(t,e,i){return h(t)[a](e,i)},getInputValue:function(t){var e;return"checkbox"===(e=h(t)).attr("type")?e.is(":checked"):e.val()}}):r.Util={bindEvent:"addEventListener"in window?function(t,e,i){return t.addEventListener(e,i,!1)}:function(t,e,i){return t.attachEvent("on"+e,i)},unbindEvent:"removeEventListener"in window?function(t,e,i){return t.removeEventListener(e,i,!1)}:function(t,e,i){return t.detachEvent("on"+e,i)},getInputValue:function(t){var e,i,n,s;if("checkbox"===t.type)return t.checked;if("select-multiple"===t.type){for(s=[],i=0,n=t.length;i<n;i++)(e=t[i]).selected&&s.push(e.value);return s}return t.value}},r.TypeParser=function(){function t(){}return t.types={primitive:0,keypath:1},t.parse=function(t){return/^'.*'$|^".*"$/.test(t)?{type:this.types.primitive,value:t.slice(1,-1)}:"true"===t?{type:this.types.primitive,value:!0}:"false"===t?{type:this.types.primitive,value:!1}:"null"===t?{type:this.types.primitive,value:null}:"undefined"===t?{type:this.types.primitive,value:void 0}:""===t?{type:this.types.primitive,value:void 0}:!1===isNaN(Number(t))?{type:this.types.primitive,value:Number(t)}:{type:this.types.keypath,value:t}},t}(),r.TextTemplateParser=function(){function t(){}return t.types={text:0,binding:1},t.parse=function(t,e){var i,n,s,r,o,h,a;for(h=[],r=t.length,i=0,n=0;n<r;){if((i=t.indexOf(e[0],n))<0){h.push({type:this.types.text,value:t.slice(n)});break}if(i>0&&n<i&&h.push({type:this.types.text,value:t.slice(n,i)}),n=i+e[0].length,(i=t.indexOf(e[1],n))<0){o=t.slice(n-e[1].length),(null!=(s=h[h.length-1])?s.type:void 0)===this.types.text?s.value+=o:h.push({type:this.types.text,value:o});break}a=t.slice(n,i).trim(),h.push({type:this.types.binding,value:a}),n=i+e[1].length}return h},t}(),r.View=function(){function t(t,e,i){var n,s,o,h,a,l,c,p,d,f,b,v,y;for(this.els=t,this.models=e,null==i&&(i={}),this.update=u(this.update,this),this.publish=u(this.publish,this),this.sync=u(this.sync,this),this.unbind=u(this.unbind,this),this.bind=u(this.bind,this),this.select=u(this.select,this),this.traverse=u(this.traverse,this),this.build=u(this.build,this),this.buildBinding=u(this.buildBinding,this),this.bindingRegExp=u(this.bindingRegExp,this),this.options=u(this.options,this),this.els.jquery||this.els instanceof Array||(this.els=[this.els]),a=0,c=(d=r.extensions).length;a<c;a++){if(this[s=d[a]]={},i[s])for(n in f=i[s])o=f[n],this[s][n]=o;for(n in b=r.public[s])o=b[n],null==(h=this[s])[n]&&(h[n]=o)}for(l=0,p=(v=r.options).length;l<p;l++)this[s=v[l]]=null!=(y=i[s])?y:r.public[s];this.build()}return t.prototype.options=function(){var t,e,i,n,s;for(e={},i=0,n=(s=r.extensions.concat(r.options)).length;i<n;i++)e[t=s[i]]=this[t];return e},t.prototype.bindingRegExp=function(){return new RegExp("^"+this.prefix+"-")},t.prototype.buildBinding=function(t,e,i,n){var s,o,h,a,l,u,c;return l={},c=function(){var t,e,i,s;for(s=[],t=0,e=(i=n.match(/((?:'[^']*')*(?:(?:[^\|']*(?:'[^']*')+[^\|']*)+|[^\|]+))|^$/g)).length;t<e;t++)u=i[t],s.push(u.trim());return s}(),a=(s=function(){var t,e,i,n;for(n=[],t=0,e=(i=c.shift().split("<")).length;t<e;t++)o=i[t],n.push(o.trim());return n}()).shift(),l.formatters=c,(h=s.shift())&&(l.dependencies=h.split(/\s+/)),this.bindings.push(new r[t](this,e,i,a,l))},t.prototype.build=function(){var t,e,i,n,s,o;for(this.bindings=[],o=this,e=function(t){var i,n,s,h,a,l,u,c,p,d,f,b,v;if(3===t.nodeType){if(a=r.TextTemplateParser,(s=o.templateDelimiters)&&(c=a.parse(t.data,s)).length&&(1!==c.length||c[0].type!==a.types.text)){for(p=0,f=c.length;p<f;p++)u=c[p],l=document.createTextNode(u.value),t.parentNode.insertBefore(l,t),1===u.type&&o.buildBinding("TextBinding",l,null,u.value);t.parentNode.removeChild(t)}}else 1===t.nodeType&&(i=o.traverse(t));if(!i)for(v=function(){var e,i,n,s;for(s=[],e=0,i=(n=t.childNodes).length;e<i;e++)h=n[e],s.push(h);return s}(),d=0,b=v.length;d<b;d++)n=v[d],e(n)},i=0,n=(s=this.els).length;i<n;i++)t=s[i],e(t);this.bindings.sort(function(t,e){var i,n;return((null!=(i=e.binder)?i.priority:void 0)||0)-((null!=(n=t.binder)?n.priority:void 0)||0)})},t.prototype.traverse=function(t){var e,i,n,s,o,h,a,l,u,c,p,d,f,b,v;for(s=this.bindingRegExp(),o="SCRIPT"===t.nodeName||"STYLE"===t.nodeName,u=0,p=(f=t.attributes).length;u<p;u++)if(e=f[u],s.test(e.name)){if(a=e.name.replace(s,""),!(n=this.binders[a]))for(h in b=this.binders)l=b[h],"*"!==h&&-1!==h.indexOf("*")&&new RegExp("^"+h.replace(/\*/g,".+")+"$").test(a)&&(n=l);n||(n=this.binders["*"]),n.block&&(o=!0,i=[e])}for(c=0,d=(v=i||t.attributes).length;c<d;c++)e=v[c],s.test(e.name)&&(a=e.name.replace(s,""),this.buildBinding("Binding",t,a,e.value));return o||(a=t.nodeName.toLowerCase(),this.components[a]&&!t._bound&&(this.bindings.push(new r.ComponentBinding(this,t,a)),o=!0)),o},t.prototype.select=function(t){var e,i,n,s,r;for(r=[],i=0,n=(s=this.bindings).length;i<n;i++)t(e=s[i])&&r.push(e);return r},t.prototype.bind=function(){var t,e,i;for(t=0,e=(i=this.bindings).length;t<e;t++)i[t].bind()},t.prototype.unbind=function(){var t,e,i;for(t=0,e=(i=this.bindings).length;t<e;t++)i[t].unbind()},t.prototype.sync=function(){var t,e,i,n;for(e=0,i=(n=this.bindings).length;e<i;e++)"function"==typeof(t=n[e]).sync&&t.sync()},t.prototype.publish=function(){var t,e,i;for(t=0,e=(i=this.select(function(t){var e;return null!=(e=t.binder)?e.publishes:void 0})).length;t<e;t++)i[t].publish()},t.prototype.update=function(t){var e,i,n,s,r,o;for(i in null==t&&(t={}),t)n=t[i],this.models[i]=n;for(s=0,r=(o=this.bindings).length;s<r;s++)"function"==typeof(e=o[s]).update&&e.update(t)},t}(),r.Binding=function(){function t(t,e,i,n,s){this.view=t,this.el=e,this.type=i,this.keypath=n,this.options=null!=s?s:{},this.getValue=u(this.getValue,this),this.update=u(this.update,this),this.unbind=u(this.unbind,this),this.bind=u(this.bind,this),this.publish=u(this.publish,this),this.sync=u(this.sync,this),this.set=u(this.set,this),this.eventHandler=u(this.eventHandler,this),this.formattedValue=u(this.formattedValue,this),this.parseFormatterArguments=u(this.parseFormatterArguments,this),this.parseTarget=u(this.parseTarget,this),this.observe=u(this.observe,this),this.setBinder=u(this.setBinder,this),this.formatters=this.options.formatters||[],this.dependencies=[],this.formatterObservers={},this.model=void 0,this.setBinder()}return t.prototype.setBinder=function(){var t,e,i;if(!(this.binder=this.view.binders[this.type]))for(t in i=this.view.binders)e=i[t],"*"!==t&&-1!==t.indexOf("*")&&new RegExp("^"+t.replace(/\*/g,".+")+"$").test(this.type)&&(this.binder=e,this.args=new RegExp("^"+t.replace(/\*/g,"(.+)")+"$").exec(this.type),this.args.shift());if(this.binder||(this.binder=this.view.binders["*"]),this.binder instanceof Function)return this.binder={routine:this.binder}},t.prototype.observe=function(t,e,i){return r.sightglass(t,e,i,{root:this.view.rootInterface,adapters:this.view.adapters})},t.prototype.parseTarget=function(){var t;return(t=r.TypeParser.parse(this.keypath)).type===r.TypeParser.types.primitive?this.value=t.value:(this.observer=this.observe(this.view.models,this.keypath,this.sync),this.model=this.observer.target)},t.prototype.parseFormatterArguments=function(t,e){var i,n,s,o,h,a,l;for(t=function(){var e,i,s;for(s=[],e=0,i=t.length;e<i;e++)n=t[e],s.push(r.TypeParser.parse(n));return s}(),o=[],i=a=0,l=t.length;a<l;i=++a)n=t[i],o.push(n.type===r.TypeParser.types.primitive?n.value:((h=this.formatterObservers)[e]||(h[e]={}),(s=this.formatterObservers[e][i])||(s=this.observe(this.view.models,n.value,this.sync),this.formatterObservers[e][i]=s),s.value()));return o},t.prototype.formattedValue=function(t){var e,i,n,s,r,o,h,a,l;for(i=o=0,h=(a=this.formatters).length;o<h;i=++o)s=(e=(n=a[i]).match(/[^\s']+|'([^']|'[^\s])*'|"([^"]|"[^\s])*"/g)).shift(),n=this.view.formatters[s],r=this.parseFormatterArguments(e,i),(null!=n?n.read:void 0)instanceof Function?t=(l=n.read).call.apply(l,[this.model,t].concat(c.call(r))):n instanceof Function&&(t=n.call.apply(n,[this.model,t].concat(c.call(r))));return t},t.prototype.eventHandler=function(t){var e,i;return i=(e=this).view.handler,function(n){return i.call(t,this,n,e)}},t.prototype.set=function(t){var e;return t=t instanceof Function&&!this.binder.function&&r.public.executeFunctions?this.formattedValue(t.call(this.model)):this.formattedValue(t),null!=(e=this.binder.routine)?e.call(this,this.el,t):void 0},t.prototype.sync=function(){var t,e;return this.set(function(){var i,n,s,r,o,h,a;if(this.observer){if(this.model!==this.observer.target){for(i=0,s=(o=this.dependencies).length;i<s;i++)(e=o[i]).unobserve();if(this.dependencies=[],null!=(this.model=this.observer.target)&&(null!=(h=this.options.dependencies)?h.length:void 0))for(n=0,r=(a=this.options.dependencies).length;n<r;n++)t=a[n],e=this.observe(this.model,t,this.sync),this.dependencies.push(e)}return this.observer.value()}return this.value}.call(this))},t.prototype.publish=function(){var t,e,i,n,s,r,o,h,a,l,u,p;if(this.observer){for(o=this.getValue(this.el),s=this.formatters.length-1,i=h=0,a=(l=this.formatters.slice(0).reverse()).length;h<a;i=++h)e=s-i,n=(t=l[i].split(/\s+/)).shift(),r=this.parseFormatterArguments(t,e),(null!=(u=this.view.formatters[n])?u.publish:void 0)&&(o=(p=this.view.formatters[n]).publish.apply(p,[o].concat(c.call(r))));return this.observer.setValue(o)}},t.prototype.bind=function(){var t,e,i,n,s,r,o;if(this.parseTarget(),null!=(s=this.binder.bind)&&s.call(this,this.el),null!=this.model&&(null!=(r=this.options.dependencies)?r.length:void 0))for(i=0,n=(o=this.options.dependencies).length;i<n;i++)t=o[i],e=this.observe(this.model,t,this.sync),this.dependencies.push(e);if(this.view.preloadData)return this.sync()},t.prototype.unbind=function(){var t,e,i,n,s,r,o,h,a;for(null!=(r=this.binder.unbind)&&r.call(this,this.el),null!=(o=this.observer)&&o.unobserve(),n=0,s=(h=this.dependencies).length;n<s;n++)h[n].unobserve();for(i in this.dependencies=[],a=this.formatterObservers)for(t in e=a[i])e[t].unobserve();return this.formatterObservers={}},t.prototype.update=function(t){var e,i;return null==t&&(t={}),this.model=null!=(e=this.observer)?e.target:void 0,null!=(i=this.binder.update)?i.call(this,t):void 0},t.prototype.getValue=function(t){return this.binder&&null!=this.binder.getValue?this.binder.getValue.call(this,t):r.Util.getInputValue(t)},t}(),r.ComponentBinding=function(t){function e(t,e,i){var n,s,o,h,a,l,c,p;for(this.view=t,this.el=e,this.type=i,this.unbind=u(this.unbind,this),this.bind=u(this.bind,this),this.locals=u(this.locals,this),this.component=this.view.components[this.type],this.static={},this.observers={},this.upstreamObservers={},s=t.bindingRegExp(),a=0,l=(c=this.el.attributes||[]).length;a<l;a++)n=c[a],s.test(n.name)||(o=this.camelCase(n.name),h=r.TypeParser.parse(n.value),f.call(null!=(p=this.component.static)?p:[],o)>=0?this.static[o]=n.value:h.type===r.TypeParser.types.primitive?this.static[o]=h.value:this.observers[o]=n.value)}return d(e,t),e.prototype.sync=function(){},e.prototype.update=function(){},e.prototype.publish=function(){},e.prototype.locals=function(){var t,e,i,n,s,r;for(t in i={},s=this.static)n=s[t],i[t]=n;for(t in r=this.observers)e=r[t],i[t]=e.value();return i},e.prototype.camelCase=function(t){return t.replace(/-([a-z])/g,function(t){return t[1].toUpperCase()})},e.prototype.bind=function(){var t,e,i,n,s,o,h,a,l,u,c,p,d,f,b,v,y,g,m,w;if(!this.bound){for(e in f=this.observers)i=f[e],this.observers[e]=this.observe(this.view.models,i,function(t){return function(e){return function(){return t.componentView.models[e]=t.observers[e].value()}}}(this).call(this,e));this.bound=!0}if(null!=this.componentView)this.componentView.bind();else{for(this.el.innerHTML=this.component.template.call(this),h=this.component.initialize.call(this,this.el,this.locals()),this.el._bound=!0,o={},u=0,p=(b=r.extensions).length;u<p;u++){if(o[s=b[u]]={},this.component[s])for(t in v=this.component[s])a=v[t],o[s][t]=a;for(t in y=this.view[s])a=y[t],null==(l=o[s])[t]&&(l[t]=a)}for(c=0,d=(g=r.options).length;c<d;c++)o[s=g[c]]=null!=(m=this.component[s])?m:this.view[s];for(e in this.componentView=new r.View(Array.prototype.slice.call(this.el.childNodes),h,o),this.componentView.bind(),w=this.observers)n=w[e],this.upstreamObservers[e]=this.observe(this.componentView.models,e,function(t){return function(e,i){return function(){return i.setValue(t.componentView.models[e])}}}(this).call(this,e,n))}},e.prototype.unbind=function(){var t,e,i,n;for(t in e=this.upstreamObservers)e[t].unobserve();for(t in i=this.observers)i[t].unobserve();return null!=(n=this.componentView)?n.unbind.call(this):void 0},e}(r.Binding),r.TextBinding=function(t){function e(t,e,i,n,s){this.view=t,this.el=e,this.type=i,this.keypath=n,this.options=null!=s?s:{},this.sync=u(this.sync,this),this.formatters=this.options.formatters||[],this.dependencies=[],this.formatterObservers={}}return d(e,t),e.prototype.binder={routine:function(t,e){return t.data=null!=e?e:""}},e.prototype.sync=function(){return e.__super__.sync.apply(this,arguments)},e}(r.Binding),r.public.binders.text=function(t,e){return null!=t.textContent?t.textContent=null!=e?e:"":t.innerText=null!=e?e:""},r.public.binders.html=function(t,e){return t.innerHTML=null!=e?e:""},r.public.binders.show=function(t,e){return t.style.display=e?"":"none"},r.public.binders.hide=function(t,e){return t.style.display=e?"none":""},r.public.binders.enabled=function(t,e){return t.disabled=!e},r.public.binders.disabled=function(t,e){return t.disabled=!!e},r.public.binders.checked={publishes:!0,priority:2e3,bind:function(t){return r.Util.bindEvent(t,"change",this.publish)},unbind:function(t){return r.Util.unbindEvent(t,"change",this.publish)},routine:function(t,e){var i;return"radio"===t.type?t.checked=(null!=(i=t.value)?i.toString():void 0)===(null!=e?e.toString():void 0):t.checked=!!e}},r.public.binders.unchecked={publishes:!0,priority:2e3,bind:function(t){return r.Util.bindEvent(t,"change",this.publish)},unbind:function(t){return r.Util.unbindEvent(t,"change",this.publish)},routine:function(t,e){var i;return"radio"===t.type?t.checked=(null!=(i=t.value)?i.toString():void 0)!==(null!=e?e.toString():void 0):t.checked=!e}},r.public.binders.value={publishes:!0,priority:3e3,bind:function(t){if("INPUT"!==t.tagName||"radio"!==t.type)return this.event="SELECT"===t.tagName?"change":"input",r.Util.bindEvent(t,this.event,this.publish)},unbind:function(t){if("INPUT"!==t.tagName||"radio"!==t.type)return r.Util.unbindEvent(t,this.event,this.publish)},routine:function(t,e){var i,n,s,r,o,a,l;if("INPUT"===t.tagName&&"radio"===t.type)return t.setAttribute("value",e);if(null!=window.jQuery){if(t=h(t),(null!=e?e.toString():void 0)!==(null!=(r=t.val())?r.toString():void 0))return t.val(null!=e?e:"")}else if("select-multiple"===t.type){if(null!=e){for(l=[],n=0,s=t.length;n<s;n++)i=t[n],l.push(i.selected=(o=i.value,f.call(e,o)>=0));return l}}else if((null!=e?e.toString():void 0)!==(null!=(a=t.value)?a.toString():void 0))return t.value=null!=e?e:""}},r.public.binders.if={block:!0,priority:4e3,bind:function(t){var e,i;if(null==this.marker)return e=[this.view.prefix,this.type].join("-").replace("--","-"),i=t.getAttribute(e),this.marker=document.createComment(" rivets: "+this.type+" "+i+" "),this.bound=!1,t.removeAttribute(e),t.parentNode.insertBefore(this.marker,t),t.parentNode.removeChild(t)},unbind:function(){if(this.nested)return this.nested.unbind(),this.bound=!1},routine:function(t,e){var i,n,s,o;if(!!e==!this.bound){if(e){for(i in s={},o=this.view.models)n=o[i],s[i]=n;return(this.nested||(this.nested=new r.View(t,s,this.view.options()))).bind(),this.marker.parentNode.insertBefore(t,this.marker.nextSibling),this.bound=!0}return t.parentNode.removeChild(t),this.nested.unbind(),this.bound=!1}},update:function(t){var e;return null!=(e=this.nested)?e.update(t):void 0}},r.public.binders.unless={block:!0,priority:4e3,bind:function(t){return r.public.binders.if.bind.call(this,t)},unbind:function(){return r.public.binders.if.unbind.call(this)},routine:function(t,e){return r.public.binders.if.routine.call(this,t,!e)},update:function(t){return r.public.binders.if.update.call(this,t)}},r.public.binders["on-*"]={function:!0,priority:1e3,unbind:function(t){if(this.handler)return r.Util.unbindEvent(t,this.args[0],this.handler)},routine:function(t,e){return this.handler&&r.Util.unbindEvent(t,this.args[0],this.handler),r.Util.bindEvent(t,this.args[0],this.handler=this.eventHandler(e))}},r.public.binders["each-*"]={block:!0,priority:4e3,bind:function(t){var e,i,n,s;if(null==this.marker)e=[this.view.prefix,this.type].join("-").replace("--","-"),this.marker=document.createComment(" rivets: "+this.type+" "),this.iterated=[],t.removeAttribute(e),t.parentNode.insertBefore(this.marker,t),t.parentNode.removeChild(t);else for(i=0,n=(s=this.iterated).length;i<n;i++)s[i].bind()},unbind:function(t){var e,i,n;if(null!=this.iterated)for(e=0,i=(n=this.iterated).length;e<i;e++)n[e].unbind()},routine:function(t,e){var i,n,s,o,h,a,l,u,c,p,d,f,b,v,y,g,m,w,k;if(a=this.args[0],e=e||[],this.iterated.length>e.length)for(d=0,v=(m=Array(this.iterated.length-e.length)).length;d<v;d++)m[d],(p=this.iterated.pop()).unbind(),this.marker.parentNode.removeChild(p.els[0]);for(s=f=0,y=e.length;f<y;s=++f)if(h=e[s],(n={index:s})[r.public.iterationAlias(a)]=s,n[a]=h,null==this.iterated[s]){for(o in w=this.view.models)h=w[o],null==n[o]&&(n[o]=h);u=this.iterated.length?this.iterated[this.iterated.length-1].els[0]:this.marker,(l=this.view.options()).preloadData=!0,c=t.cloneNode(!0),(p=new r.View(c,n,l)).bind(),this.iterated.push(p),this.marker.parentNode.insertBefore(c,u.nextSibling)}else this.iterated[s].models[a]!==h&&this.iterated[s].update(n);if("OPTION"===t.nodeName)for(b=0,g=(k=this.view.bindings).length;b<g;b++)(i=k[b]).el===this.marker.parentNode&&"value"===i.type&&i.sync()},update:function(t){var e,i,n,s,r,o;for(i in e={},t)n=t[i],i!==this.args[0]&&(e[i]=n);for(s=0,r=(o=this.iterated).length;s<r;s++)o[s].update(e)}},r.public.binders["class-*"]=function(t,e){var i;if(!e==(-1!==(i=" "+t.className+" ").indexOf(" "+this.args[0]+" ")))return t.className=e?t.className+" "+this.args[0]:i.replace(" "+this.args[0]+" "," ").trim()},r.public.binders["*"]=function(t,e){return null!=e?t.setAttribute(this.type,e):t.removeAttribute(this.type)},r.public.formatters.call=function(){var t,e;return e=arguments[0],t=2<=arguments.length?c.call(arguments,1):[],e.call.apply(e,[this].concat(c.call(t)))},r.public.adapters["."]={id:"_rv",counter:0,weakmap:{},weakReference:function(t){var e,i,n;return t.hasOwnProperty(this.id)||(e=this.counter++,Object.defineProperty(t,this.id,{value:e})),(i=this.weakmap)[n=t[this.id]]||(i[n]={callbacks:{}})},cleanupWeakReference:function(t,e){if(!(Object.keys(t.callbacks).length||t.pointers&&Object.keys(t.pointers).length))return delete this.weakmap[e]},stubFunction:function(t,e){var i,n,s;return n=t[e],i=this.weakReference(t),s=this.weakmap,t[e]=function(){var e,r,o,h,a,l,u,c,p;for(r in o=n.apply(t,arguments),l=i.pointers)for(e=l[r],h=0,a=(p=null!=(u=null!=(c=s[r])?c.callbacks[e]:void 0)?u:[]).length;h<a;h++)(0,p[h])();return o}},observeMutations:function(t,e,i){var n,s,r,o,h,a;if(Array.isArray(t)){if(null==(r=this.weakReference(t)).pointers)for(r.pointers={},h=0,a=(s=["push","pop","shift","unshift","sort","reverse","splice"]).length;h<a;h++)n=s[h],this.stubFunction(t,n);if(null==(o=r.pointers)[e]&&(o[e]=[]),f.call(r.pointers[e],i)<0)return r.pointers[e].push(i)}},unobserveMutations:function(t,e,i){var n,s,r;if(Array.isArray(t)&&null!=t[this.id]&&(s=this.weakmap[t[this.id]])&&(r=s.pointers[e]))return(n=r.indexOf(i))>=0&&r.splice(n,1),r.length||delete s.pointers[e],this.cleanupWeakReference(s,t[this.id])},observe:function(t,e,i){var n,s,r,o;return null==(n=this.weakReference(t).callbacks)[e]&&(n[e]=[],(null!=(s=Object.getOwnPropertyDescriptor(t,e))?s.get:void 0)||(null!=s?s.set:void 0)||(r=t[e],Object.defineProperty(t,e,{enumerable:!0,get:function(){return r},set:(o=this,function(i){var s,h,a,l,u;if(i!==r&&(o.unobserveMutations(r,t[o.id],e),r=i,h=o.weakmap[t[o.id]])){if((n=h.callbacks)[e])for(a=0,l=(u=n[e].slice()).length;a<l;a++)s=u[a],f.call(n[e],s)>=0&&s();return o.observeMutations(i,t[o.id],e)}})}))),f.call(n[e],i)<0&&n[e].push(i),this.observeMutations(t[e],t[this.id],e)},unobserve:function(t,e,i){var n,s,r;if((r=this.weakmap[t[this.id]])&&(n=r.callbacks[e]))return(s=n.indexOf(i))>=0&&(n.splice(s,1),n.length||(delete r.callbacks[e],this.unobserveMutations(t[e],t[this.id],e))),this.cleanupWeakReference(r,t[this.id])},get:function(t,e){return t[e]},set:function(t,e,i){return t[e]=i}},r.factory=function(t){return r.sightglass=t,r.public._=r,r.public},"object"==typeof(null!==t?t.exports:void 0)?t.exports=r.factory(i(0)):(n=[i(0)],void 0===(s=function(t){return this.rivets=r.factory(t)}.apply(e,n))||(t.exports=s))}).call(this)}).call(this,i(3)(t))},function(t,e){t.exports=function(t){return t.webpackPolyfill||(t.deprecate=function(){},t.paths=[],t.children||(t.children=[]),Object.defineProperty(t,"loaded",{enumerable:!0,get:function(){return t.l}}),Object.defineProperty(t,"id",{enumerable:!0,get:function(){return t.i}}),t.webpackPolyfill=1),t}},function(t,e,i){},,,function(t,e,i){"use strict";i.r(e);class n{constructor(t){this.endpoint=t,this.params=new Array,this.addParam("origin","*").addParam("format","json")}addParam(t,e){const i=new s(t,e);return this.params.push(i),this}get url(){let t=this.endpoint;return this.params.forEach(e=>{t+=e.key+"="+e.value+"&"}),t}}class s{constructor(t,e){this._key=t,this._value=e}get key(){return this._key}set key(t){this._key=t}get value(){return this._value}set value(t){this._value=t}}class r{constructor(t){this.lang=t}fetchExtract(t){const e=this.constructQuery(t);return fetch(e.url).then(t=>{200===t.status&&t.json().then(t=>{console.log(t)})})}constructQuery(t){const e="https://"+this.lang.id.toLowerCase()+".wikipedia.org/w/api.php?";let i=new n(e);return i.addParam("action","query").addParam("prop","info|description|categories|extlinks|pageterms|extracts&exintro").addParam("inprop","url").addParam("redirects","1").addParam("titles",t),i}}class o{constructor(t,e,i){this.id=t,this.name=e,this.priority=i}get url(){return"https://"+this.id.toLowerCase()+".wikipedia.org"}}!function(t){t.EN=new t("EN","English",1)}(o||(o={}));class h{constructor(t){this.elements=t||[]}add(t){return!this.has(t)&&(this.elements.push(t),!0)}set(t,e){const i=this.elements[t];return this.elements[t]=e,i}remove(t){for(let e=0;e<this.elements.length;e++)if(this.elements[e].equals(t)){const t=this.elements[e];return this.elements.splice(e,1),t}return null}clear(){this.elements=[]}has(t){for(let e of this.elements)if(e.equals(t))return!0;return!1}override(t){this.elements=t}}class a{constructor(t,e){this._leftNode=t,this._rightNode=t,this._text=t.textContent,this._offset=e}phrase(t,e){let i=0,n=0;if(function(t){const e=t.charCodeAt(0);return e>=12288&&e<=12543||e>=65280&&e<=65519||e>=19968&&e<=40879||e>=13312&&e<=19903}(this.text.charAt(this.offset)))i=this.offset-t,n=this.offset+e+1;else{if(c(this.text[this.offset]))return"";let s=this.offset;for(let t=0;t<=e;t++){for(;!1===c(this.text[s]);){if(s>=this.text.length-1){if(!l(this.rightNode))break;this.joinAfter(),s--}s++}s++}n=s;let r=this.offset.valueOf();s=this.offset;for(let e=0;e<=t;e++){for(;!1===c(this.text[s]);){if(s<=0){if(!u(this.leftNode))break;const t=t=>t+this.offset-r;this.joinBefore(),s=t(s),n=t(n),r=this.offset,s++}s--}s--}i=s+=2}let s=this.text.substring(i,n);return s=s.replace(/([.,\'\"\/#!$%\^&\*;:{}=\-_`~()、。])/,"").trim()}joinAfter(){this.rightNode=l(this.rightNode),this.addAfter(this.rightNode.textContent)}joinBefore(){this.leftNode=u(this.leftNode),this.addBefore(this.leftNode.textContent)}addAfter(t){this.text+=t}addBefore(t){this.text=t+this.text,this.offset+=t.length}get text(){return this._text}set text(t){this._text=t}get offset(){return this._offset}set offset(t){this._offset=t}get leftNode(){return this._leftNode}set leftNode(t){this._leftNode=t}get rightNode(){return this._rightNode}set rightNode(t){this._rightNode=t}}function l(t){return null===t.nextSibling?t.parentNode.nextSibling:t.nextSibling}function u(t){return null===t.previousSibling?t.parentNode.previousSibling:t.previousSibling}function c(t){return" "===t||/(\\n)/.test(JSON.stringify(t))}class p{getSourceUnderCursor(t){const e=document.caretPositionFromPoint(t.clientX,t.clientY),i=e.offsetNode,n=e.offset;return new a(i,n)}}const d=i(2);class f{constructor(){this.width=f.DEFAULT_WIDTH,this.height=f.DEFAULT_HEIGHT,this.frame=document.createElement("iframe"),this.frame.id="wikichan",this.frame.name="wikichan",this.frame.src=browser.runtime.getURL("frame.html"),this.frame.frameBorder="0",this.frame.style.width=`${this.width}px`,this.frame.style.height=`${this.height}px`,this.frame.style.position="fixed",this.frame.style.visibility="hidden",document.body.appendChild(this.frame)}open(t,e,i){this.frame.style.top=`${t}px`,this.frame.style.left=`${e}px`,this.frame.style.visibility="visible",d.bind(this.resultsContainer,i)}close(){this.frame.style.visibility="hidden"}get documentContainer(){return this.frame.contentWindow.document}get resultsContainer(){return this.documentContainer.getElementById("results")}}f.DEFAULT_WIDTH=475,f.DEFAULT_HEIGHT=300;const b=new class{constructor(t){this.pages=new h,this.service=t||new r(o.EN),this.selector=new p,this.display=new f}get(t){if(!t.altKey)return this.pages.clear(),void this.display.close();const e=this.selector.getSourceUnderCursor(t);this.display.open(t.clientY,t.clientX,this.pages);for(let t=0;t<4;t++)for(let i=0;i<4;i++){const n=e.phrase(t,i);this.service.fetchExtract(n).then(t=>{})}}};window.addEventListener("mousedown",b.get.bind(b));const v=document.createElement("link");v.rel="stylesheet",v.type="text/css",v.href=browser.runtime.getURL("css/wikichan.css"),document.head.appendChild(v)}]);
!function(t){var e={};function r(i){if(e[i])return e[i].exports;var s=e[i]={i:i,l:!1,exports:{}};return t[i].call(s.exports,s,s.exports,r),s.l=!0,s.exports}r.m=t,r.c=e,r.d=function(t,e,i){r.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:i})},r.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},r.t=function(t,e){if(1&e&&(t=r(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var i=Object.create(null);if(r.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var s in t)r.d(i,s,function(e){return t[e]}.bind(null,s));return i},r.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return r.d(e,"a",e),e},r.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},r.p="",r(r.s=0)}([function(t,e,r){r(2),t.exports=r(1)},function(t,e,r){},function(t,e,r){"use strict";r.r(e);class i{constructor(t,e){this._key=t,this._value=e}get key(){return this._key}set key(t){this._key=t}get value(){return this._value}set value(t){this._value=t}}class s{constructor(t,e){this.endpoint=t,this.params=new Array,this._type=e,this.addParam("origin","*").addParam("format","json")}addParam(t,e){const r=new i(t,e);return this.params.push(r),this}get url(){let t=this.endpoint;return this.params.forEach(e=>{t+=e.key+"="+e.value+"&"}),t}get type(){return this._type}}var n;!function(t){t[t.EXTRACT=0]="EXTRACT"}(n||(n={}));class o{constructor(){this._redirects=[],this._pages=[]}addRedirect(t){this._redirects.push(t)}addPage(t){this._pages.push(t)}get redirects(){return this._redirects}get pages(){return this._pages}static fromJson(t){const e=new o;return t.normalized&&t.normalized.forEach(t=>{e.addRedirect(h.fromJson(t))}),t.redirects&&t.redirects.forEach(t=>{e.addRedirect(h.fromJson(t))}),Object.keys(t.pages).forEach((r,i)=>{+r<0||e.addPage(a.fromJson(t.pages[r]))}),e}}class a{constructor(){}get id(){return this._id}get title(){return this._title}get summary(){return this._summary}static fromJson(t){const e=new a;return e._id=t.pageid,e._title=t.title,e._summary=t.extract,e}}class h{constructor(){}get from(){return this._from}get to(){return this._to}static fromJson(t){const e=new h;return e._from=t.from,e._to=t.to,e}}var c=function(t,e,r,i){return new(r||(r=Promise))(function(s,n){function o(t){try{h(i.next(t))}catch(t){n(t)}}function a(t){try{h(i.throw(t))}catch(t){n(t)}}function h(t){t.done?s(t.value):new r(function(e){e(t.value)}).then(o,a)}h((i=i.apply(t,e||[])).next())})};class u{constructor(){this.endpoint="https://en.wikipedia.org/w/api.php?"}fetchExtract(t){return c(this,void 0,void 0,function*(){const e=this.constructQuery(t,n.EXTRACT);return new Promise(function(t,r){const i=new XMLHttpRequest;i.open("GET",e.url),i.setRequestHeader("Content-Type","application/json; charset=UTF-8"),i.onloadend=function(){if(this.status>=200&&this.status<300){const e=JSON.parse(this.responseText).query;if(-1!==Object.keys(e.pages).indexOf("-1")&&1===Object.keys(e.pages).length)return;console.log(e.pages);const r=o.fromJson(e);t(r)}else r({status:this.status,statusText:this.statusText})},i.onerror=function(){r({status:this.status,statusText:this.statusText})},i.send()})})}constructQuery(t,e){let r=new s(this.endpoint,e);return r.addParam("action","query").addParam("prop","info|extracts").addParam("inprop","url").addParam("redirects","1").addParam("titles",t),r}}class d{constructor(t,e){this._leftNode=t,this._rightNode=t,this._text=t.textContent,this._offset=e}phrase(t,e){let r,i,s=this.offset;for(let e=0;e<t+1;e++){for(;s>0&&(s--," "!==this.text[s]););s<0&&this.joinBefore()}r=s,s=this.offset;for(let t=0;t<e+1;t++){for(;s<this.text.length&&(s++," "!==this.text[s]););s>this.text.length&&this.joinAfter()}return i=s,this.cleanString(this.text.substring(r,i))}cleanString(t){return t.replace("/[.,/#!$%^&*;:{}=-_`~()]/g","").trim()}joinAfter(){var t;this.rightNode=null===(t=this.rightNode).nextSibling?t.parentNode.nextSibling:t.nextSibling,this.addAfter(this.rightNode.textContent)}joinBefore(){var t;this.leftNode=null===(t=this.leftNode).previousSibling?t.parentNode.previousSibling:t.previousSibling,this.addBefore(this.leftNode.textContent)}addAfter(t){this.text+=t}addBefore(t){this.text=t+this.text,this.offset+=t.length}get text(){return this._text}set text(t){this._text=t}get offset(){return this._offset}set offset(t){this._offset=t}get leftNode(){return this._leftNode}set leftNode(t){this._leftNode=t}get rightNode(){return this._rightNode}set rightNode(t){this._rightNode=t}}class f{getSourceUnderCursor(t){const e=document.caretPositionFromPoint(t.clientX,t.clientY),r=e.offsetNode,i=e.offset;return new d(r,i)}}class l{constructor(){this._container=document.createElement("iframe"),this._container.src=browser.runtime.getURL("frame.html"),this._container.style.visibility="hidden",this._container.id="wikichan",this._container.style.width="300px",this._container.style.height="300px",this._container.style.position="fixed",document.body.appendChild(this._container)}show(){this._container.style.top=`${this.top}px`,this._container.style.left=`${this.left}px`,this._container.style.visibility="visible"}setLocation(t,e){this.top=e,this.left=t}get top(){return this._top}set top(t){this._top=t}get left(){return this._left}set left(t){this._left=t}get height(){return this._height}set height(t){this._height=t}get width(){return this._width}set width(t){this._width=t}}(new class{constructor(){this.wikic=new u,this.selector=new f}prepare(){window.addEventListener("mousedown",this.onMouseOver.bind(this)),window.wikiframe=new l}onMouseOver(t){const e=this.selector.getSourceUnderCursor(t);window.wikiframe.setLocation(t.clientX,t.clientY),window.wikiframe.show();for(let t=0;t<4;t++)for(let r=0;r<4;r++)this.wikic.fetchExtract(e.phrase(t,r)).then(function(t){},function(t){console.log(t.stack)})}}).prepare()}]);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vd2VicGFjay9ib290c3RyYXAiLCJ3ZWJwYWNrOi8vLy4vc3JjL3RzL2FwaS9wYXJhbXMudHMiLCJ3ZWJwYWNrOi8vLy4vc3JjL3RzL2FwaS9xdWVyeS50cyIsIndlYnBhY2s6Ly8vLi9zcmMvdHMvYXBpL3Jlc3BvbnNlLnRzIiwid2VicGFjazovLy8uL3NyYy90cy9hcGkvd2lraWFwaS50cyIsIndlYnBhY2s6Ly8vLi9zcmMvdHMvZG9jLWJpbmQvdGV4dC1zb3VyY2UudHMiLCJ3ZWJwYWNrOi8vLy4vc3JjL3RzL2RvYy1iaW5kL3RleHQtc2VsZWN0b3IudHMiLCJ3ZWJwYWNrOi8vLy4vc3JjL3RzL2Rpc3BsYXkvZGlzcGxheS50cyIsIndlYnBhY2s6Ly8vLi9zcmMvdHMvd2lraWNoYW4udHMiXSwibmFtZXMiOlsiaW5zdGFsbGVkTW9kdWxlcyIsIl9fd2VicGFja19yZXF1aXJlX18iLCJtb2R1bGVJZCIsImV4cG9ydHMiLCJtb2R1bGUiLCJpIiwibCIsIm1vZHVsZXMiLCJjYWxsIiwibSIsImMiLCJkIiwibmFtZSIsImdldHRlciIsIm8iLCJPYmplY3QiLCJkZWZpbmVQcm9wZXJ0eSIsImVudW1lcmFibGUiLCJnZXQiLCJyIiwiU3ltYm9sIiwidG9TdHJpbmdUYWciLCJ2YWx1ZSIsInQiLCJtb2RlIiwiX19lc01vZHVsZSIsIm5zIiwiY3JlYXRlIiwia2V5IiwiYmluZCIsIm4iLCJvYmplY3QiLCJwcm9wZXJ0eSIsInByb3RvdHlwZSIsImhhc093blByb3BlcnR5IiwicCIsInMiLCJXaWtpUXVlcnlQYXJhbXMiLCJbb2JqZWN0IE9iamVjdF0iLCJ0aGlzIiwiX2tleSIsIl92YWx1ZSIsInF1ZXJ5X1dpa2lRdWVyeSIsImVuZHBvaW50IiwidHlwZSIsInBhcmFtcyIsIkFycmF5IiwiX3R5cGUiLCJhZGRQYXJhbSIsInBhcmFtIiwicHVzaCIsInVybCIsInF1ZXJ5IiwiZm9yRWFjaCIsIldpa2lRdWVyeVR5cGUiLCJXaWtpUmVzcG9uc2UiLCJfcmVkaXJlY3RzIiwiX3BhZ2VzIiwicmVkaXJlY3RzIiwicGFnZXMiLCJqc29uIiwicmVzIiwibm9ybWFsaXplZCIsImFkZFJlZGlyZWN0IiwiV2lraVJlZGlyZWN0IiwiZnJvbUpzb24iLCJrZXlzIiwiayIsInYiLCJhZGRQYWdlIiwiV2lraVBhZ2UiLCJpZCIsIl9pZCIsInRpdGxlIiwiX3RpdGxlIiwic3VtbWFyeSIsIl9zdW1tYXJ5IiwicGFnZWlkIiwiZXh0cmFjdCIsImZyb20iLCJfZnJvbSIsInRvIiwiX3RvIiwiX19hd2FpdGVyIiwidGhpc0FyZyIsIl9hcmd1bWVudHMiLCJQIiwiZ2VuZXJhdG9yIiwiUHJvbWlzZSIsInJlc29sdmUiLCJyZWplY3QiLCJmdWxmaWxsZWQiLCJzdGVwIiwibmV4dCIsImUiLCJyZWplY3RlZCIsInJlc3VsdCIsImRvbmUiLCJ0aGVuIiwiYXBwbHkiLCJ3aWtpYXBpX1dpa2lBcGkiLCJhcnRpY2xlTmFtZSIsImNvbnN0cnVjdFF1ZXJ5IiwiRVhUUkFDVCIsInhociIsIlhNTEh0dHBSZXF1ZXN0Iiwib3BlbiIsInNldFJlcXVlc3RIZWFkZXIiLCJvbmxvYWRlbmQiLCJzdGF0dXMiLCJKU09OIiwicGFyc2UiLCJyZXNwb25zZVRleHQiLCJpbmRleE9mIiwibGVuZ3RoIiwiY29uc29sZSIsImxvZyIsInJlc3BvbnNlIiwic3RhdHVzVGV4dCIsIm9uZXJyb3IiLCJzZW5kIiwiYXJ0aWNsZSIsIlRleHRTb3VyY2UiLCJub2RlIiwib2Zmc2V0IiwiX2xlZnROb2RlIiwiX3JpZ2h0Tm9kZSIsIl90ZXh0IiwidGV4dENvbnRlbnQiLCJfb2Zmc2V0IiwiYmVmb3JlIiwiYWZ0ZXIiLCJiZWdpbiIsImVuZCIsInRleHQiLCJqb2luQmVmb3JlIiwiam9pbkFmdGVyIiwiY2xlYW5TdHJpbmciLCJzdWJzdHJpbmciLCJyZXBsYWNlIiwidHJpbSIsInJpZ2h0Tm9kZSIsIm5leHRTaWJsaW5nIiwicGFyZW50Tm9kZSIsImFkZEFmdGVyIiwibGVmdE5vZGUiLCJwcmV2aW91c1NpYmxpbmciLCJhZGRCZWZvcmUiLCJ0ZXh0X3NlbGVjdG9yX1RleHRTZWxlY3RvciIsImV2ZW50IiwicmFuZ2UiLCJkb2N1bWVudCIsImNhcmV0UG9zaXRpb25Gcm9tUG9pbnQiLCJjbGllbnRYIiwiY2xpZW50WSIsInRleHROb2RlIiwib2Zmc2V0Tm9kZSIsIlJlc3BvbnNlRGlzcGxheSIsIl9jb250YWluZXIiLCJjcmVhdGVFbGVtZW50Iiwic3JjIiwiYnJvd3NlciIsInJ1bnRpbWUiLCJnZXRVUkwiLCJzdHlsZSIsInZpc2liaWxpdHkiLCJ3aWR0aCIsImhlaWdodCIsInBvc2l0aW9uIiwiYm9keSIsImFwcGVuZENoaWxkIiwidG9wIiwibGVmdCIsIngiLCJ5IiwiX3RvcCIsIl9sZWZ0IiwiX2hlaWdodCIsIl93aWR0aCIsIndpa2ljIiwic2VsZWN0b3IiLCJ3aW5kb3ciLCJhZGRFdmVudExpc3RlbmVyIiwib25Nb3VzZU92ZXIiLCJ3aWtpZnJhbWUiLCJzb3VyY2UiLCJnZXRTb3VyY2VVbmRlckN1cnNvciIsInNldExvY2F0aW9uIiwic2hvdyIsImZldGNoRXh0cmFjdCIsInBocmFzZSIsInN0YWNrIiwicHJlcGFyZSJdLCJtYXBwaW5ncyI6ImFBQ0EsSUFBQUEsRUFBQSxHQUdBLFNBQUFDLEVBQUFDLEdBR0EsR0FBQUYsRUFBQUUsR0FDQSxPQUFBRixFQUFBRSxHQUFBQyxRQUdBLElBQUFDLEVBQUFKLEVBQUFFLEdBQUEsQ0FDQUcsRUFBQUgsRUFDQUksR0FBQSxFQUNBSCxRQUFBLElBVUEsT0FOQUksRUFBQUwsR0FBQU0sS0FBQUosRUFBQUQsUUFBQUMsSUFBQUQsUUFBQUYsR0FHQUcsRUFBQUUsR0FBQSxFQUdBRixFQUFBRCxRQUtBRixFQUFBUSxFQUFBRixFQUdBTixFQUFBUyxFQUFBVixFQUdBQyxFQUFBVSxFQUFBLFNBQUFSLEVBQUFTLEVBQUFDLEdBQ0FaLEVBQUFhLEVBQUFYLEVBQUFTLElBQ0FHLE9BQUFDLGVBQUFiLEVBQUFTLEVBQUEsQ0FBMENLLFlBQUEsRUFBQUMsSUFBQUwsS0FL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SUFBeUIvRSxFQUN6QjdELEtBQUE2SSxTQUFBLElBQTRCaEMsRUFFNUI5RyxVQUNBK0ksT0FBQUMsaUJBQUEsWUFBQS9JLEtBQUFnSixZQUFBMUosS0FBQVUsT0FDQThJLE9BQUFHLFVBQUEsSUFBK0IzQixFQUUvQnZILFlBQUF3RCxHQUNBLE1BQUEyRixFQUFBbEosS0FBQTZJLFNBQUFNLHFCQUFBNUYsR0FDQXVGLE9BQUFHLFVBQUFHLFlBQUE3RixFQUFBMkQsUUFBQTNELEVBQUE0RCxTQUNBMkIsT0FBQUcsVUFBQUksT0FDQSxRQUFBMUQsRUFBQSxFQUE0QkEsRUFBQSxFQUFZQSxJQUN4QyxRQUFBQyxFQUFBLEVBQStCQSxFQUFBLEVBQVdBLElBQzFDNUYsS0FBQTRJLE1BQUFVLGFBQUFKLEVBQUFLLE9BQUE1RCxFQUFBQyxJQUNBakMsS0FBQSxTQUFBckMsS0FDaUIsU0FBQWlDLEdBQ2pCcUIsUUFBQUMsSUFBQXRCLEVBQUFpRyxZQU9BQyIsImZpbGUiOiJqcy9idW5kbGUuanMiLCJzb3VyY2VzQ29udGVudCI6WyIgXHQvLyBUaGUgbW9kdWxlIGNhY2hlXG4gXHR2YXIgaW5zdGFsbGVkTW9kdWxlcyA9IHt9O1xuXG4gXHQvLyBUaGUgcmVxdWlyZSBmdW5jdGlvblxuIFx0ZnVuY3Rpb24gX193ZWJwYWNrX3JlcXVpcmVfXyhtb2R1bGVJZCkge1xuXG4gXHRcdC8vIENoZWNrIGlmIG1vZHVsZSBpcyBpbiBjYWNoZVxuIFx0XHRpZihpbnN0YWxsZWRNb2R1bGVzW21vZHVsZUlkXSkge1xuIFx0XHRcdHJldHVybiBpbnN0YWxsZWRNb2R1bGVzW21vZHVsZUlkXS5leHBvcnRzO1xuIFx0XHR9XG4gXHRcdC8vIENyZWF0ZSBhIG5ldyBtb2R1bGUgKGFuZCBwdXQgaXQgaW50byB0aGUgY2FjaGUpXG4gXHRcdHZhciBtb2R1bGUgPSBpbnN0YWxsZWRNb2R1bGVzW21vZHVsZUlkXSA9IHtcbiBcdFx0XHRpOiBtb2R1bGVJZCxcbiBcdFx0XHRsOiBmYWxzZSxcbiBcdFx0XHRleHBvcnRzOiB7fVxuIFx0XHR9O1xuXG4gXHRcdC8vIEV4ZWN1dGUgdGhlIG1vZHVsZSBmdW5jdGlvblxuIFx0XHRtb2R1bGVzW21vZHVsZUlkXS5jYWxsKG1vZHVsZS5leHBvcnRzLCBtb2R1bGUsIG1vZHVsZS5leHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKTtcblxuIFx0XHQvLyBGbGFnIHRoZSBtb2R1bGUgYXMgbG9hZGVkXG4gXHRcdG1vZHVsZS5sID0gdHJ1ZTtcblxuIFx0XHQvLyBSZXR1cm4gdGhlIGV4cG9ydHMgb2YgdGhlIG1vZHVsZVxuIFx0XHRyZXR1cm4gbW9kdWxlLmV4cG9ydHM7XG4gXHR9XG5cblxuIFx0Ly8gZXhwb3NlIHRoZSBtb2R1bGVzIG9iamVjdCAoX193ZWJwYWNrX21vZHVsZXNfXylcbiBcdF9fd2VicGFja19yZXF1aXJlX18ubSA9IG1vZHVsZXM7XG5cbiBcdC8vIGV4cG9zZSB0aGUgbW9kdWxlIGNhY2hlXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLmMgPSBpbnN0YWxsZWRNb2R1bGVzO1xuXG4gXHQvLyBkZWZpbmUgZ2V0dGVyIGZ1bmN0aW9uIGZvciBoYXJtb255IGV4cG9ydHNcbiBcdF9fd2VicGFja19yZXF1aXJlX18uZCA9IGZ1bmN0aW9uKGV4cG9ydHMsIG5hbWUsIGdldHRlcikge1xuIFx0XHRpZighX193ZWJwYWNrX3JlcXVpcmVfXy5vKGV4cG9ydHMsIG5hbWUpKSB7XG4gXHRcdFx0T2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIG5hbWUsIHsgZW51bWVyYWJsZTogdHJ1ZSwgZ2V0OiBnZXR0ZXIgfSk7XG4gXHRcdH1cbiBcdH07XG5cbiBcdC8vIGRlZmluZSBfX2VzTW9kdWxlIG9uIGV4cG9ydHNcbiBcdF9fd2VicGFja19yZXF1aXJlX18uciA9IGZ1bmN0aW9uKGV4cG9ydHMpIHtcbiBcdFx0aWYodHlwZW9mIFN5bWJvbCAhPT0gJ3VuZGVmaW5lZCcgJiYgU3ltYm9sLnRvU3RyaW5nVGFnKSB7XG4gXHRcdFx0T2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFN5bWJvbC50b1N0cmluZ1RhZywgeyB2YWx1ZTogJ01vZHVsZScgfSk7XG4gXHRcdH1cbiBcdFx0T2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICdfX2VzTW9kdWxlJywgeyB2YWx1ZTogdHJ1ZSB9KTtcbiBcdH07XG5cbiBcdC8vIGNyZWF0ZSBhIGZha2UgbmFtZXNwYWNlIG9iamVjdFxuIFx0Ly8gbW9kZSAmIDE6IHZhbHVlIGlzIGEgbW9kdWxlIGlkLCByZXF1aXJlIGl0XG4gXHQvLyBtb2RlICYgMjogbWVyZ2UgYWxsIHByb3BlcnRpZXMgb2YgdmFsdWUgaW50byB0aGUgbnNcbiBcdC8vIG1vZGUgJiA0OiByZXR1cm4gdmFsdWUgd2hlbiBhbHJlYWR5IG5zIG9iamVjdFxuIFx0Ly8gbW9kZSAmIDh8MTogYmVoYXZlIGxpa2UgcmVxdWlyZVxuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy50ID0gZnVuY3Rpb24odmFsdWUsIG1vZGUpIHtcbiBcdFx0aWYobW9kZSAmIDEpIHZhbHVlID0gX193ZWJwYWNrX3JlcXVpcmVfXyh2YWx1ZSk7XG4gXHRcdGlmKG1vZGUgJiA4KSByZXR1cm4gdmFsdWU7XG4gXHRcdGlmKChtb2RlICYgNCkgJiYgdHlwZW9mIHZhbHVlID09PSAnb2JqZWN0JyAmJiB2YWx1ZSAmJiB2YWx1ZS5fX2VzTW9kdWxlKSByZXR1cm4gdmFsdWU7XG4gXHRcdHZhciBucyA9IE9iamVjdC5jcmVhdGUobnVsbCk7XG4gXHRcdF9fd2VicGFja19yZXF1aXJlX18ucihucyk7XG4gXHRcdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShucywgJ2RlZmF1bHQnLCB7IGVudW1lcmFibGU6IHRydWUsIHZhbHVlOiB2YWx1ZSB9KTtcbiBcdFx0aWYobW9kZSAmIDIgJiYgdHlwZW9mIHZhbHVlICE9ICdzdHJpbmcnKSBmb3IodmFyIGtleSBpbiB2YWx1ZSkgX193ZWJwYWNrX3JlcXVpcmVfXy5kKG5zLCBrZXksIGZ1bmN0aW9uKGtleSkgeyByZXR1cm4gdmFsdWVba2V5XTsgfS5iaW5kKG51bGwsIGtleSkpO1xuIFx0XHRyZXR1cm4gbnM7XG4gXHR9O1xuXG4gXHQvLyBnZXREZWZhdWx0RXhwb3J0IGZ1bmN0aW9uIGZvciBjb21wYXRpYmlsaXR5IHdpdGggbm9uLWhhcm1vbnkgbW9kdWxlc1xuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5uID0gZnVuY3Rpb24obW9kdWxlKSB7XG4gXHRcdHZhciBnZXR0ZXIgPSBtb2R1bGUgJiYgbW9kdWxlLl9fZXNNb2R1bGUgP1xuIFx0XHRcdGZ1bmN0aW9uIGdldERlZmF1bHQoKSB7IHJldHVybiBtb2R1bGVbJ2RlZmF1bHQnXTsgfSA6XG4gXHRcdFx0ZnVuY3Rpb24gZ2V0TW9kdWxlRXhwb3J0cygpIHsgcmV0dXJuIG1vZHVsZTsgfTtcbiBcdFx0X193ZWJwYWNrX3JlcXVpcmVfXy5kKGdldHRlciwgJ2EnLCBnZXR0ZXIpO1xuIFx0XHRyZXR1cm4gZ2V0dGVyO1xuIFx0fTtcblxuIFx0Ly8gT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLm8gPSBmdW5jdGlvbihvYmplY3QsIHByb3BlcnR5KSB7IHJldHVybiBPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwob2JqZWN0LCBwcm9wZXJ0eSk7IH07XG5cbiBcdC8vIF9fd2VicGFja19wdWJsaWNfcGF0aF9fXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLnAgPSBcIlwiO1xuXG5cbiBcdC8vIExvYWQgZW50cnkgbW9kdWxlIGFuZCByZXR1cm4gZXhwb3J0c1xuIFx0cmV0dXJuIF9fd2VicGFja19yZXF1aXJlX18oX193ZWJwYWNrX3JlcXVpcmVfXy5zID0gMCk7XG4iLCJleHBvcnQgY2xhc3MgV2lraVF1ZXJ5UGFyYW1zIHtcclxuICAgIGNvbnN0cnVjdG9yKGtleSwgdmFsdWUpIHtcclxuICAgICAgICB0aGlzLl9rZXkgPSBrZXk7XHJcbiAgICAgICAgdGhpcy5fdmFsdWUgPSB2YWx1ZTtcclxuICAgIH1cclxuICAgIGdldCBrZXkoKSB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuX2tleTtcclxuICAgIH1cclxuICAgIHNldCBrZXkodmFsdWUpIHtcclxuICAgICAgICB0aGlzLl9rZXkgPSB2YWx1ZTtcclxuICAgIH1cclxuICAgIGdldCB2YWx1ZSgpIHtcclxuICAgICAgICByZXR1cm4gdGhpcy5fdmFsdWU7XHJcbiAgICB9XHJcbiAgICBzZXQgdmFsdWUodmFsdWUpIHtcclxuICAgICAgICB0aGlzLl92YWx1ZSA9IHZhbHVlO1xyXG4gICAgfVxyXG59XHJcbiIsImltcG9ydCB7IFdpa2lRdWVyeVBhcmFtcyB9IGZyb20gJy4vcGFyYW1zJztcclxuZXhwb3J0IGNsYXNzIFdpa2lRdWVyeSB7XHJcbiAgICBjb25zdHJ1Y3RvcihlbmRwb2ludCwgdHlwZSkge1xyXG4gICAgICAgIHRoaXMuZW5kcG9pbnQgPSBlbmRwb2ludDtcclxuICAgICAgICB0aGlzLnBhcmFtcyA9IG5ldyBBcnJheSgpO1xyXG4gICAgICAgIHRoaXMuX3R5cGUgPSB0eXBlO1xyXG4gICAgICAgIHRoaXMuYWRkUGFyYW0oJ29yaWdpbicsICcqJylcclxuICAgICAgICAgICAgLmFkZFBhcmFtKCdmb3JtYXQnLCAnanNvbicpO1xyXG4gICAgfVxyXG4gICAgYWRkUGFyYW0oa2V5LCB2YWx1ZSkge1xyXG4gICAgICAgIGNvbnN0IHBhcmFtID0gbmV3IFdpa2lRdWVyeVBhcmFtcyhrZXksIHZhbHVlKTtcclxuICAgICAgICB0aGlzLnBhcmFtcy5wdXNoKHBhcmFtKTtcclxuICAgICAgICByZXR1cm4gdGhpcztcclxuICAgIH1cclxuICAgIGdldCB1cmwoKSB7XHJcbiAgICAgICAgbGV0IHF1ZXJ5ID0gdGhpcy5lbmRwb2ludDtcclxuICAgICAgICB0aGlzLnBhcmFtcy5mb3JFYWNoKHAgPT4ge1xyXG4gICAgICAgICAgICBxdWVyeSArPSBwLmtleSArIFwiPVwiICsgcC52YWx1ZSArIFwiJlwiO1xyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIHJldHVybiBxdWVyeTtcclxuICAgIH1cclxuICAgIGdldCB0eXBlKCkge1xyXG4gICAgICAgIHJldHVybiB0aGlzLl90eXBlO1xyXG4gICAgfVxyXG59XHJcbmV4cG9ydCB2YXIgV2lraVF1ZXJ5VHlwZTtcclxuKGZ1bmN0aW9uIChXaWtpUXVlcnlUeXBlKSB7XHJcbiAgICBXaWtpUXVlcnlUeXBlW1dpa2lRdWVyeVR5cGVbXCJFWFRSQUNUXCJdID0gMF0gPSBcIkVYVFJBQ1RcIjtcclxufSkoV2lraVF1ZXJ5VHlwZSB8fCAoV2lraVF1ZXJ5VHlwZSA9IHt9KSk7XHJcbiIsImV4cG9ydCBjbGFzcyBXaWtpUmVzcG9uc2Uge1xyXG4gICAgY29uc3RydWN0b3IoKSB7XHJcbiAgICAgICAgdGhpcy5fcmVkaXJlY3RzID0gW107XHJcbiAgICAgICAgdGhpcy5fcGFnZXMgPSBbXTtcclxuICAgIH1cclxuICAgIGFkZFJlZGlyZWN0KHIpIHtcclxuICAgICAgICB0aGlzLl9yZWRpcmVjdHMucHVzaChyKTtcclxuICAgIH1cclxuICAgIGFkZFBhZ2UocCkge1xyXG4gICAgICAgIHRoaXMuX3BhZ2VzLnB1c2gocCk7XHJcbiAgICB9XHJcbiAgICBnZXQgcmVkaXJlY3RzKCkge1xyXG4gICAgICAgIHJldHVybiB0aGlzLl9yZWRpcmVjdHM7XHJcbiAgICB9XHJcbiAgICBnZXQgcGFnZXMoKSB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuX3BhZ2VzO1xyXG4gICAgfVxyXG4gICAgc3RhdGljIGZyb21Kc29uKGpzb24pIHtcclxuICAgICAgICBjb25zdCByZXMgPSBuZXcgV2lraVJlc3BvbnNlKCk7XHJcbiAgICAgICAgaWYgKGpzb24ubm9ybWFsaXplZCkge1xyXG4gICAgICAgICAgICBqc29uLm5vcm1hbGl6ZWQuZm9yRWFjaChuID0+IHtcclxuICAgICAgICAgICAgICAgIHJlcy5hZGRSZWRpcmVjdChXaWtpUmVkaXJlY3QuZnJvbUpzb24obikpO1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKGpzb24ucmVkaXJlY3RzKSB7XHJcbiAgICAgICAgICAgIGpzb24ucmVkaXJlY3RzLmZvckVhY2gociA9PiB7XHJcbiAgICAgICAgICAgICAgICByZXMuYWRkUmVkaXJlY3QoV2lraVJlZGlyZWN0LmZyb21Kc29uKHIpKTtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIE9iamVjdC5rZXlzKGpzb24ucGFnZXMpLmZvckVhY2goKGssIHYpID0+IHtcclxuICAgICAgICAgICAgaWYgKCtrIDwgMCkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHJlcy5hZGRQYWdlKFdpa2lQYWdlLmZyb21Kc29uKGpzb24ucGFnZXNba10pKTtcclxuICAgICAgICB9KTtcclxuICAgICAgICByZXR1cm4gcmVzO1xyXG4gICAgfVxyXG59XHJcbmV4cG9ydCBjbGFzcyBXaWtpUGFnZSB7XHJcbiAgICBjb25zdHJ1Y3RvcigpIHsgfVxyXG4gICAgZ2V0IGlkKCkge1xyXG4gICAgICAgIHJldHVybiB0aGlzLl9pZDtcclxuICAgIH1cclxuICAgIGdldCB0aXRsZSgpIHtcclxuICAgICAgICByZXR1cm4gdGhpcy5fdGl0bGU7XHJcbiAgICB9XHJcbiAgICBnZXQgc3VtbWFyeSgpIHtcclxuICAgICAgICByZXR1cm4gdGhpcy5fc3VtbWFyeTtcclxuICAgIH1cclxuICAgIHN0YXRpYyBmcm9tSnNvbihqc29uKSB7XHJcbiAgICAgICAgY29uc3QgcmVzID0gbmV3IFdpa2lQYWdlKCk7XHJcbiAgICAgICAgcmVzLl9pZCA9IGpzb24ucGFnZWlkO1xyXG4gICAgICAgIHJlcy5fdGl0bGUgPSBqc29uLnRpdGxlO1xyXG4gICAgICAgIHJlcy5fc3VtbWFyeSA9IGpzb24uZXh0cmFjdDtcclxuICAgICAgICByZXR1cm4gcmVzO1xyXG4gICAgfVxyXG59XHJcbmNsYXNzIFdpa2lSZWRpcmVjdCB7XHJcbiAgICBjb25zdHJ1Y3RvcigpIHsgfVxyXG4gICAgZ2V0IGZyb20oKSB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuX2Zyb207XHJcbiAgICB9XHJcbiAgICBnZXQgdG8oKSB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuX3RvO1xyXG4gICAgfVxyXG4gICAgc3RhdGljIGZyb21Kc29uKGpzb24pIHtcclxuICAgICAgICBjb25zdCByZXMgPSBuZXcgV2lraVJlZGlyZWN0KCk7XHJcbiAgICAgICAgcmVzLl9mcm9tID0ganNvbi5mcm9tO1xyXG4gICAgICAgIHJlcy5fdG8gPSBqc29uLnRvO1xyXG4gICAgICAgIHJldHVybiByZXM7XHJcbiAgICB9XHJcbn1cclxuIiwidmFyIF9fYXdhaXRlciA9ICh0aGlzICYmIHRoaXMuX19hd2FpdGVyKSB8fCBmdW5jdGlvbiAodGhpc0FyZywgX2FyZ3VtZW50cywgUCwgZ2VuZXJhdG9yKSB7XHJcbiAgICByZXR1cm4gbmV3IChQIHx8IChQID0gUHJvbWlzZSkpKGZ1bmN0aW9uIChyZXNvbHZlLCByZWplY3QpIHtcclxuICAgICAgICBmdW5jdGlvbiBmdWxmaWxsZWQodmFsdWUpIHsgdHJ5IHsgc3RlcChnZW5lcmF0b3IubmV4dCh2YWx1ZSkpOyB9IGNhdGNoIChlKSB7IHJlamVjdChlKTsgfSB9XHJcbiAgICAgICAgZnVuY3Rpb24gcmVqZWN0ZWQodmFsdWUpIHsgdHJ5IHsgc3RlcChnZW5lcmF0b3JbXCJ0aHJvd1wiXSh2YWx1ZSkpOyB9IGNhdGNoIChlKSB7IHJlamVjdChlKTsgfSB9XHJcbiAgICAgICAgZnVuY3Rpb24gc3RlcChyZXN1bHQpIHsgcmVzdWx0LmRvbmUgPyByZXNvbHZlKHJlc3VsdC52YWx1ZSkgOiBuZXcgUChmdW5jdGlvbiAocmVzb2x2ZSkgeyByZXNvbHZlKHJlc3VsdC52YWx1ZSk7IH0pLnRoZW4oZnVsZmlsbGVkLCByZWplY3RlZCk7IH1cclxuICAgICAgICBzdGVwKChnZW5lcmF0b3IgPSBnZW5lcmF0b3IuYXBwbHkodGhpc0FyZywgX2FyZ3VtZW50cyB8fCBbXSkpLm5leHQoKSk7XHJcbiAgICB9KTtcclxufTtcclxuaW1wb3J0IHsgV2lraVF1ZXJ5VHlwZSwgV2lraVF1ZXJ5IH0gZnJvbSAnLi9xdWVyeSc7XHJcbmltcG9ydCB7IFdpa2lSZXNwb25zZSB9IGZyb20gJy4vcmVzcG9uc2UnO1xyXG5leHBvcnQgY2xhc3MgV2lraUFwaSB7XHJcbiAgICBjb25zdHJ1Y3RvcigpIHtcclxuICAgICAgICB0aGlzLmVuZHBvaW50ID0gJ2h0dHBzOi8vZW4ud2lraXBlZGlhLm9yZy93L2FwaS5waHA/JztcclxuICAgIH1cclxuICAgIGZldGNoRXh0cmFjdChhcnRpY2xlTmFtZSkge1xyXG4gICAgICAgIHJldHVybiBfX2F3YWl0ZXIodGhpcywgdm9pZCAwLCB2b2lkIDAsIGZ1bmN0aW9uKiAoKSB7XHJcbiAgICAgICAgICAgIGNvbnN0IHF1ZXJ5ID0gdGhpcy5jb25zdHJ1Y3RRdWVyeShhcnRpY2xlTmFtZSwgV2lraVF1ZXJ5VHlwZS5FWFRSQUNUKTtcclxuICAgICAgICAgICAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uIChyZXNvbHZlLCByZWplY3QpIHtcclxuICAgICAgICAgICAgICAgIGNvbnN0IHhociA9IG5ldyBYTUxIdHRwUmVxdWVzdCgpO1xyXG4gICAgICAgICAgICAgICAgeGhyLm9wZW4oJ0dFVCcsIHF1ZXJ5LnVybCk7XHJcbiAgICAgICAgICAgICAgICB4aHIuc2V0UmVxdWVzdEhlYWRlcignQ29udGVudC1UeXBlJywgJ2FwcGxpY2F0aW9uL2pzb247IGNoYXJzZXQ9VVRGLTgnKTtcclxuICAgICAgICAgICAgICAgIHhoci5vbmxvYWRlbmQgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXMuc3RhdHVzID49IDIwMCAmJiB0aGlzLnN0YXR1cyA8IDMwMCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBqc29uID0gSlNPTi5wYXJzZSh0aGlzLnJlc3BvbnNlVGV4dCkucXVlcnk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChPYmplY3Qua2V5cyhqc29uLnBhZ2VzKS5pbmRleE9mKFwiLTFcIikgIT09IC0xICYmIE9iamVjdC5rZXlzKGpzb24ucGFnZXMpLmxlbmd0aCA9PT0gMSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKGpzb24ucGFnZXMpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdCByZXNwb25zZSA9IFdpa2lSZXNwb25zZS5mcm9tSnNvbihqc29uKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZShyZXNwb25zZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByZWplY3Qoe1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc3RhdHVzOiB0aGlzLnN0YXR1cyxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0YXR1c1RleHQ6IHRoaXMuc3RhdHVzVGV4dFxyXG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9O1xyXG4gICAgICAgICAgICAgICAgeGhyLm9uZXJyb3IgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmVqZWN0KHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgc3RhdHVzOiB0aGlzLnN0YXR1cyxcclxuICAgICAgICAgICAgICAgICAgICAgICAgc3RhdHVzVGV4dDogdGhpcy5zdGF0dXNUZXh0XHJcbiAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICB9O1xyXG4gICAgICAgICAgICAgICAgeGhyLnNlbmQoKTtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9XHJcbiAgICAvLyBUT0RPOiBSZWZhY3RvciBmb3IgZGlmZmVyZW50IHR5cGVzIG9mIHF1ZXJpZXNcclxuICAgIGNvbnN0cnVjdFF1ZXJ5KGFydGljbGUsIHR5cGUpIHtcclxuICAgICAgICBsZXQgcXVlcnkgPSBuZXcgV2lraVF1ZXJ5KHRoaXMuZW5kcG9pbnQsIHR5cGUpO1xyXG4gICAgICAgIHF1ZXJ5LmFkZFBhcmFtKCdhY3Rpb24nLCAncXVlcnknKVxyXG4gICAgICAgICAgICAuYWRkUGFyYW0oJ3Byb3AnLCAnaW5mb3xleHRyYWN0cycpXHJcbiAgICAgICAgICAgIC5hZGRQYXJhbSgnaW5wcm9wJywgJ3VybCcpXHJcbiAgICAgICAgICAgIC5hZGRQYXJhbSgncmVkaXJlY3RzJywgJzEnKVxyXG4gICAgICAgICAgICAuYWRkUGFyYW0oJ3RpdGxlcycsIGFydGljbGUpO1xyXG4gICAgICAgIHJldHVybiBxdWVyeTtcclxuICAgIH1cclxufVxyXG4iLCJleHBvcnQgY2xhc3MgVGV4dFNvdXJjZSB7XHJcbiAgICBjb25zdHJ1Y3Rvcihub2RlLCBvZmZzZXQpIHtcclxuICAgICAgICB0aGlzLl9sZWZ0Tm9kZSA9IG5vZGU7XHJcbiAgICAgICAgdGhpcy5fcmlnaHROb2RlID0gbm9kZTtcclxuICAgICAgICB0aGlzLl90ZXh0ID0gbm9kZS50ZXh0Q29udGVudDtcclxuICAgICAgICB0aGlzLl9vZmZzZXQgPSBvZmZzZXQ7XHJcbiAgICB9XHJcbiAgICBwaHJhc2UoYmVmb3JlLCBhZnRlcikge1xyXG4gICAgICAgIGxldCBpID0gdGhpcy5vZmZzZXQ7XHJcbiAgICAgICAgbGV0IGJlZ2luO1xyXG4gICAgICAgIGxldCBlbmQ7XHJcbiAgICAgICAgZm9yIChsZXQgayA9IDA7IGsgPCBiZWZvcmUgKyAxOyBrKyspIHtcclxuICAgICAgICAgICAgd2hpbGUgKGkgPiAwKSB7XHJcbiAgICAgICAgICAgICAgICBpLS07XHJcbiAgICAgICAgICAgICAgICBpZiAodGhpcy50ZXh0W2ldID09PSBcIiBcIilcclxuICAgICAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBpZiAoaSA8IDApIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuam9pbkJlZm9yZSgpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGJlZ2luID0gaTtcclxuICAgICAgICBpID0gdGhpcy5vZmZzZXQ7XHJcbiAgICAgICAgZm9yIChsZXQgayA9IDA7IGsgPCBhZnRlciArIDE7IGsrKykge1xyXG4gICAgICAgICAgICB3aGlsZSAoaSA8IHRoaXMudGV4dC5sZW5ndGgpIHtcclxuICAgICAgICAgICAgICAgIGkrKztcclxuICAgICAgICAgICAgICAgIGlmICh0aGlzLnRleHRbaV0gPT09IFwiIFwiKVxyXG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGlmIChpID4gdGhpcy50ZXh0Lmxlbmd0aCkge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5qb2luQWZ0ZXIoKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICBlbmQgPSBpO1xyXG4gICAgICAgIHJldHVybiB0aGlzLmNsZWFuU3RyaW5nKHRoaXMudGV4dC5zdWJzdHJpbmcoYmVnaW4sIGVuZCkpO1xyXG4gICAgfVxyXG4gICAgY2xlYW5TdHJpbmcocykge1xyXG4gICAgICAgIHJldHVybiBzLnJlcGxhY2UoXCIvWy4sXFwvIyEkJVxcXiZcXCo7Ont9PVxcLV9gfigpXS9nXCIsIFwiXCIpLnRyaW0oKTtcclxuICAgIH1cclxuICAgIGpvaW5BZnRlcigpIHtcclxuICAgICAgICB0aGlzLnJpZ2h0Tm9kZSA9IGdldE5leHROb2RlKHRoaXMucmlnaHROb2RlKTtcclxuICAgICAgICB0aGlzLmFkZEFmdGVyKHRoaXMucmlnaHROb2RlLnRleHRDb250ZW50KTtcclxuICAgIH1cclxuICAgIGpvaW5CZWZvcmUoKSB7XHJcbiAgICAgICAgdGhpcy5sZWZ0Tm9kZSA9IGdldFByZXZpb3VzTm9kZSh0aGlzLmxlZnROb2RlKTtcclxuICAgICAgICB0aGlzLmFkZEJlZm9yZSh0aGlzLmxlZnROb2RlLnRleHRDb250ZW50KTtcclxuICAgIH1cclxuICAgIGFkZEFmdGVyKHRleHQpIHtcclxuICAgICAgICB0aGlzLnRleHQgKz0gdGV4dDtcclxuICAgIH1cclxuICAgIGFkZEJlZm9yZSh0ZXh0KSB7XHJcbiAgICAgICAgdGhpcy50ZXh0ID0gdGV4dCArIHRoaXMudGV4dDtcclxuICAgICAgICB0aGlzLm9mZnNldCArPSB0ZXh0Lmxlbmd0aDtcclxuICAgIH1cclxuICAgIGdldCB0ZXh0KCkge1xyXG4gICAgICAgIHJldHVybiB0aGlzLl90ZXh0O1xyXG4gICAgfVxyXG4gICAgc2V0IHRleHQodmFsdWUpIHtcclxuICAgICAgICB0aGlzLl90ZXh0ID0gdmFsdWU7XHJcbiAgICB9XHJcbiAgICBnZXQgb2Zmc2V0KCkge1xyXG4gICAgICAgIHJldHVybiB0aGlzLl9vZmZzZXQ7XHJcbiAgICB9XHJcbiAgICBzZXQgb2Zmc2V0KHZhbHVlKSB7XHJcbiAgICAgICAgdGhpcy5fb2Zmc2V0ID0gdmFsdWU7XHJcbiAgICB9XHJcbiAgICBnZXQgbGVmdE5vZGUoKSB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuX2xlZnROb2RlO1xyXG4gICAgfVxyXG4gICAgc2V0IGxlZnROb2RlKHZhbHVlKSB7XHJcbiAgICAgICAgdGhpcy5fbGVmdE5vZGUgPSB2YWx1ZTtcclxuICAgIH1cclxuICAgIGdldCByaWdodE5vZGUoKSB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuX3JpZ2h0Tm9kZTtcclxuICAgIH1cclxuICAgIHNldCByaWdodE5vZGUodmFsdWUpIHtcclxuICAgICAgICB0aGlzLl9yaWdodE5vZGUgPSB2YWx1ZTtcclxuICAgIH1cclxufVxyXG5mdW5jdGlvbiBnZXROZXh0Tm9kZShub2RlKSB7XHJcbiAgICByZXR1cm4gbm9kZS5uZXh0U2libGluZyA9PT0gbnVsbCA/IG5vZGUucGFyZW50Tm9kZS5uZXh0U2libGluZyA6IG5vZGUubmV4dFNpYmxpbmc7XHJcbn1cclxuZnVuY3Rpb24gZ2V0UHJldmlvdXNOb2RlKG5vZGUpIHtcclxuICAgIHJldHVybiBub2RlLnByZXZpb3VzU2libGluZyA9PT0gbnVsbCA/IG5vZGUucGFyZW50Tm9kZS5wcmV2aW91c1NpYmxpbmcgOiBub2RlLnByZXZpb3VzU2libGluZztcclxufVxyXG4iLCJpbXBvcnQgeyBUZXh0U291cmNlIH0gZnJvbSBcIi4vdGV4dC1zb3VyY2VcIjtcclxuZXhwb3J0IGNsYXNzIFRleHRTZWxlY3RvciB7XHJcbiAgICBnZXRTb3VyY2VVbmRlckN1cnNvcihldmVudCkge1xyXG4gICAgICAgIGNvbnN0IHJhbmdlID0gZG9jdW1lbnQuY2FyZXRQb3NpdGlvbkZyb21Qb2ludChldmVudC5jbGllbnRYLCBldmVudC5jbGllbnRZKTtcclxuICAgICAgICBjb25zdCB0ZXh0Tm9kZSA9IHJhbmdlLm9mZnNldE5vZGU7XHJcbiAgICAgICAgY29uc3Qgb2Zmc2V0ID0gcmFuZ2Uub2Zmc2V0O1xyXG4gICAgICAgIGNvbnN0IHNvdXJjZSA9IG5ldyBUZXh0U291cmNlKHRleHROb2RlLCBvZmZzZXQpO1xyXG4gICAgICAgIHJldHVybiBzb3VyY2U7XHJcbiAgICB9XHJcbn1cclxuIiwiZXhwb3J0IGNsYXNzIFJlc3BvbnNlRGlzcGxheSB7XHJcbiAgICBjb25zdHJ1Y3RvcigpIHtcclxuICAgICAgICB0aGlzLl9jb250YWluZXIgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdpZnJhbWUnKTtcclxuICAgICAgICB0aGlzLl9jb250YWluZXIuc3JjID0gYnJvd3Nlci5ydW50aW1lLmdldFVSTCgnZnJhbWUuaHRtbCcpO1xyXG4gICAgICAgIHRoaXMuX2NvbnRhaW5lci5zdHlsZS52aXNpYmlsaXR5ID0gJ2hpZGRlbic7XHJcbiAgICAgICAgdGhpcy5fY29udGFpbmVyLmlkID0gXCJ3aWtpY2hhblwiO1xyXG4gICAgICAgIHRoaXMuX2NvbnRhaW5lci5zdHlsZS53aWR0aCA9ICczMDBweCc7XHJcbiAgICAgICAgdGhpcy5fY29udGFpbmVyLnN0eWxlLmhlaWdodCA9ICczMDBweCc7XHJcbiAgICAgICAgdGhpcy5fY29udGFpbmVyLnN0eWxlLnBvc2l0aW9uID0gJ2ZpeGVkJztcclxuICAgICAgICBkb2N1bWVudC5ib2R5LmFwcGVuZENoaWxkKHRoaXMuX2NvbnRhaW5lcik7XHJcbiAgICB9XHJcbiAgICBzaG93KCkge1xyXG4gICAgICAgIHRoaXMuX2NvbnRhaW5lci5zdHlsZS50b3AgPSBgJHt0aGlzLnRvcH1weGA7XHJcbiAgICAgICAgdGhpcy5fY29udGFpbmVyLnN0eWxlLmxlZnQgPSBgJHt0aGlzLmxlZnR9cHhgO1xyXG4gICAgICAgIHRoaXMuX2NvbnRhaW5lci5zdHlsZS52aXNpYmlsaXR5ID0gJ3Zpc2libGUnO1xyXG4gICAgfVxyXG4gICAgc2V0TG9jYXRpb24oeCwgeSkge1xyXG4gICAgICAgIHRoaXMudG9wID0geTtcclxuICAgICAgICB0aGlzLmxlZnQgPSB4O1xyXG4gICAgfVxyXG4gICAgZ2V0IHRvcCgpIHtcclxuICAgICAgICByZXR1cm4gdGhpcy5fdG9wO1xyXG4gICAgfVxyXG4gICAgc2V0IHRvcCh2YWx1ZSkge1xyXG4gICAgICAgIHRoaXMuX3RvcCA9IHZhbHVlO1xyXG4gICAgfVxyXG4gICAgZ2V0IGxlZnQoKSB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuX2xlZnQ7XHJcbiAgICB9XHJcbiAgICBzZXQgbGVmdCh2YWx1ZSkge1xyXG4gICAgICAgIHRoaXMuX2xlZnQgPSB2YWx1ZTtcclxuICAgIH1cclxuICAgIGdldCBoZWlnaHQoKSB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuX2hlaWdodDtcclxuICAgIH1cclxuICAgIHNldCBoZWlnaHQodmFsdWUpIHtcclxuICAgICAgICB0aGlzLl9oZWlnaHQgPSB2YWx1ZTtcclxuICAgIH1cclxuICAgIGdldCB3aWR0aCgpIHtcclxuICAgICAgICByZXR1cm4gdGhpcy5fd2lkdGg7XHJcbiAgICB9XHJcbiAgICBzZXQgd2lkdGgodmFsdWUpIHtcclxuICAgICAgICB0aGlzLl93aWR0aCA9IHZhbHVlO1xyXG4gICAgfVxyXG59XHJcbiIsImltcG9ydCB7IFdpa2lBcGkgfSBmcm9tIFwiLi9hcGkvd2lraWFwaVwiO1xyXG5pbXBvcnQgeyBUZXh0U2VsZWN0b3IgfSBmcm9tIFwiLi9kb2MtYmluZC90ZXh0LXNlbGVjdG9yXCI7XHJcbmltcG9ydCB7IFJlc3BvbnNlRGlzcGxheSB9IGZyb20gXCIuL2Rpc3BsYXkvZGlzcGxheVwiO1xyXG5jbGFzcyBXaWtpY2hhbiB7XHJcbiAgICBjb25zdHJ1Y3RvcigpIHtcclxuICAgICAgICB0aGlzLndpa2ljID0gbmV3IFdpa2lBcGkoKTtcclxuICAgICAgICB0aGlzLnNlbGVjdG9yID0gbmV3IFRleHRTZWxlY3RvcigpO1xyXG4gICAgfVxyXG4gICAgcHJlcGFyZSgpIHtcclxuICAgICAgICB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcignbW91c2Vkb3duJywgdGhpcy5vbk1vdXNlT3Zlci5iaW5kKHRoaXMpKTtcclxuICAgICAgICB3aW5kb3cud2lraWZyYW1lID0gbmV3IFJlc3BvbnNlRGlzcGxheSgpO1xyXG4gICAgfVxyXG4gICAgb25Nb3VzZU92ZXIoZSkge1xyXG4gICAgICAgIGNvbnN0IHNvdXJjZSA9IHRoaXMuc2VsZWN0b3IuZ2V0U291cmNlVW5kZXJDdXJzb3IoZSk7XHJcbiAgICAgICAgd2luZG93Lndpa2lmcmFtZS5zZXRMb2NhdGlvbihlLmNsaWVudFgsIGUuY2xpZW50WSk7XHJcbiAgICAgICAgd2luZG93Lndpa2lmcmFtZS5zaG93KCk7XHJcbiAgICAgICAgZm9yIChsZXQgYmVmb3JlID0gMDsgYmVmb3JlIDwgNDsgYmVmb3JlKyspIHtcclxuICAgICAgICAgICAgZm9yIChsZXQgYWZ0ZXIgPSAwOyBhZnRlciA8IDQ7IGFmdGVyKyspIHtcclxuICAgICAgICAgICAgICAgIHRoaXMud2lraWMuZmV0Y2hFeHRyYWN0KHNvdXJjZS5waHJhc2UoYmVmb3JlLCBhZnRlcikpXHJcbiAgICAgICAgICAgICAgICAgICAgLnRoZW4oZnVuY3Rpb24gKHJlcykge1xyXG4gICAgICAgICAgICAgICAgfSwgZnVuY3Rpb24gKGUpIHtcclxuICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhlLnN0YWNrKTtcclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG59XHJcbmNvbnN0IHdpa2ljaGFuID0gbmV3IFdpa2ljaGFuKCk7XHJcbndpa2ljaGFuLnByZXBhcmUoKTtcclxuIl0sInNvdXJjZVJvb3QiOiIifQ==